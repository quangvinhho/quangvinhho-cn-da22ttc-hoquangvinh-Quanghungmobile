<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Chi tiết sản phẩm - QuangHưng Mobile</title>
    <meta name="description" content="Xem chi tiết sản phẩm điện thoại và phụ kiện chính hãng. Giá tốt, bảo hành chính hãng, giao hàng miễn phí.">
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="điện thoại, iPhone, Samsung, Sony Xperia, phụ kiện điện thoại, tai nghe, sạc, ốp lưng">
    <meta name="author" content="QuangHưng Mobile">
    <meta name="robots" content="index, follow">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
      :root {
        /* WCAG 2.1 AA Compliant Colors */
        --red-main: #d91e23;
        --red-dark: #b01117;
        --red-light: #ffe5e6;
        --red-accent: #ff1a1a;
        
        /* Text colors */
        --text-primary: #1a1a1a;
        --text-secondary: #4a4a4a;
        --text-muted: #666666;
        
        /* Background colors */
        --bg-main: #ffffff;
        --bg-secondary: #f5f5f5;
        --bg-card: #ffffff;
        
        /* Border colors */
        --border-light: #d4d4d4;
        --border-medium: #a3a3a3;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    
    <!-- Header Navigation Component -->
    <div id="header-nav-placeholder"></div>
    
    <script>
        // Load header component with cache busting
        const headerVersion = '?v=' + new Date().getTime();
        fetch('components/header.html' + headerVersion)
            .then(response => response.text())
            .then(html => {
                document.getElementById('header-nav-placeholder').innerHTML = html;
                
                // Initialize mobile menu after header is loaded
                setTimeout(() => {
                    const script = document.createElement('script');
                    script.src = 'components/header-menu.js';
                    document.body.appendChild(script);
                }, 100);
            })
            .catch(error => console.error('Error loading header:', error));
    </script>

    <!-- Breadcrumb -->
    <div class="bg-white border-b">
      <div class="container mx-auto px-4 py-3">
        <div class="flex items-center space-x-2 text-sm">
          <a href="index.html" class="text-gray-600 hover:text-red-600">Trang chủ</a>
          <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
          <a href="products.html" class="text-gray-600 hover:text-red-600">Sản phẩm</a>
          <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
          <span id="breadcrumbProduct" class="text-red-600">Đang tải...</span>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-8">
      <!-- Product Details Container (Dynamic) -->
      <div id="productContainer" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
        <!-- Product content will be dynamically loaded here -->
        <div class="col-span-2 text-center py-20">
          <i class="fas fa-spinner fa-spin text-4xl text-red-600 mb-4"></i>
          <p class="text-gray-600">Đang tải thông tin sản phẩm...</p>
        </div>
      </div>

      <!-- Related Products -->
      <div class="mb-8">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800">Sản phẩm liên quan</h2>
            <p class="text-gray-600 text-sm mt-1">Khám phá thêm những sản phẩm tương tự</p>
          </div>
          <a href="products.html" class="text-red-600 hover:text-red-700 font-semibold text-sm flex items-center gap-2 group">
            Xem tất cả
            <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
          </a>
        </div>
        <div id="relatedProducts" class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
          <!-- Dynamic related products will be rendered here -->
        </div>
      </div>
    </div>

    <div id="footer"></div>
    <script src="main.js"></script>

    <script>
      // ===== PRODUCT DATA (same as products.html) =====
      const PRODUCTS = [
        {id:1,name:'Samsung Galaxy A06 5G 4GB 128GB',brand:'samsung',category:'dienthoai',price:3420000,oldPrice:3920000,discount:13,ram:4,storage:128,screen:'6.7 inch',camera:'50MP',battery:'5000 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#e8f5e9','#000000'],image:'https://images.unsplash.com/photo-1610945415295-d9bbf067e59c?w=400&h=400&fit=crop'},
        {id:2,name:'Samsung Galaxy A07 4GB 128GB',brand:'samsung',category:'dienthoai',price:3190000,oldPrice:3390000,discount:6,ram:4,storage:128,screen:'6.7 inch',camera:'50MP',battery:'5000 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#000000','#4fc3f7','#006064'],image:'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=400&fit=crop'},
        {id:3,name:'Samsung Galaxy A16 4GB 128GB',brand:'samsung',category:'dienthoai',price:3700000,oldPrice:5000000,discount:26,ram:4,storage:128,screen:'6.7" Super AMOLED FHD+',camera:'50MP',battery:'5000 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#000000','#e0e0e0'],image:'https://images.unsplash.com/photo-1585060544812-6b45742d762f?w=400&h=400&fit=crop'},
        {id:4,name:'OPPO A5i 4GB 64GB',brand:'oppo',category:'dienthoai',price:3290000,ram:4,storage:64,screen:'6.7 inch',camera:'50MP góc siêu rộng',battery:'5000 mAh',os:'Android 13',features:['tragop'],colors:['#9575cd','#b39ddb'],image:'https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=400&h=400&fit=crop'},
        {id:5,name:'iPhone 15 Pro Max 256GB',brand:'iphone',category:'dienthoai',price:28990000,oldPrice:34990000,discount:17,ram:8,storage:256,screen:'6.7"',camera:'48MP',battery:'4422 mAh',os:'iOS 17',features:['tragop','freeship'],colors:['#4a4a4a','#e8e8e8','#ffd700'],image:'https://images.unsplash.com/photo-1695048064998-18d5e69328c6?w=400&h=400&fit=crop'},
        {id:6,name:'Xiaomi 14 5G 512GB',brand:'xiaomi',category:'dienthoai',price:18990000,oldPrice:24990000,discount:24,ram:12,storage:512,screen:'6.36"',camera:'50MP',battery:'4610 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#81c784','#000000'],image:'https://images.unsplash.com/photo-1574944985070-8f3ebc6b79d2?w=400&h=400&fit=crop'},
        {id:7,name:'OPPO Reno12 F 5G 8GB 256GB',brand:'oppo',category:'dienthoai',price:8290000,oldPrice:9990000,discount:17,ram:8,storage:256,screen:'6.67"',camera:'50MP',battery:'5000 mAh',os:'Android 14',features:['tragop'],colors:['#ff9800','#9c27b0'],image:'https://images.unsplash.com/photo-1592286927505-ed01dd7d2c8f?w=400&h=400&fit=crop'},
        {id:8,name:'HONOR X7c 8GB 256GB',brand:'honor',category:'dienthoai',price:4790000,oldPrice:5990000,discount:20,ram:8,storage:256,screen:'6.77"',camera:'108MP',battery:'6000 mAh',os:'Android 13',features:['tragop'],colors:['#000000','#4fc3f7'],image:'https://images.unsplash.com/photo-1581993192008-63e896f4f744?w=400&h=400&fit=crop'},
        {id:9,name:'Samsung Galaxy S24 Ultra 12GB 256GB',brand:'samsung',category:'dienthoai',price:29990000,oldPrice:33990000,discount:12,ram:12,storage:256,screen:'6.8" Dynamic AMOLED 2X',camera:'200MP',battery:'5000 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#9e9e9e','#000000','#b39ddb'],image:'https://images.unsplash.com/photo-1610945264803-c22b62d2a7b4?w=400&h=400&fit=crop'},
        {id:10,name:'iPhone 14 Pro 128GB',brand:'iphone',category:'dienthoai',price:24990000,oldPrice:27990000,discount:11,ram:6,storage:128,screen:'6.1"',camera:'48MP',battery:'3200 mAh',os:'iOS 16',features:['tragop','freeship'],colors:['#4a148c','#000000','#ffd700'],image:'https://images.unsplash.com/photo-1663499482523-1c0c1bae4ce1?w=400&h=400&fit=crop'},
        {id:11,name:'Xiaomi Redmi Note 13 Pro 8GB 256GB',brand:'xiaomi',category:'dienthoai',price:6990000,oldPrice:8990000,discount:22,ram:8,storage:256,screen:'6.67" AMOLED',camera:'200MP',battery:'5100 mAh',os:'Android 13',features:['tragop','freeship'],colors:['#9c27b0','#000000','#e3f2fd'],image:'https://images.unsplash.com/photo-1580910051074-3eb694886505?w=400&h=400&fit=crop'},
        {id:12,name:'OPPO Find N3 Flip 12GB 256GB',brand:'oppo',category:'dienthoai',price:19990000,oldPrice:22990000,discount:13,ram:12,storage:256,screen:'6.8"',camera:'50MP',battery:'4300 mAh',os:'Android 13',features:['tragop','freeship'],colors:['#ffc107','#f48fb1'],image:'https://images.unsplash.com/photo-1583573503122-a3c6ce6ec1e0?w=400&h=400&fit=crop'},
        {id:13,name:'Samsung Galaxy Z Flip5 8GB 256GB',brand:'samsung',category:'dienthoai',price:16990000,oldPrice:20990000,discount:19,ram:8,storage:256,screen:'6.7" Foldable AMOLED',camera:'12MP',battery:'3700 mAh',os:'Android 13',features:['tragop','freeship'],colors:['#b39ddb','#ffeb3b','#000000'],image:'https://images.unsplash.com/photo-1591122947157-26bad3a117d2?w=400&h=400&fit=crop'},
        {id:14,name:'iPhone 13 128GB',brand:'iphone',category:'dienthoai',price:17990000,oldPrice:18990000,discount:5,ram:4,storage:128,screen:'6.1"',camera:'12MP',battery:'3240 mAh',os:'iOS 15',features:['tragop','freeship'],colors:['#f48fb1','#000000','#e3f2fd','#ffffff'],image:'https://images.unsplash.com/photo-1632661674318-1c8e2b54d4f7?w=400&h=400&fit=crop'},
        {id:15,name:'Xiaomi 13T Pro 12GB 512GB',brand:'xiaomi',category:'dienthoai',price:12990000,oldPrice:14990000,discount:13,ram:12,storage:512,screen:'6.67" AMOLED',camera:'50MP',battery:'5000 mAh',os:'Android 13',features:['tragop','freeship'],colors:['#000000','#90caf9'],image:'https://images.unsplash.com/photo-1567581935884-3349723552ca?w=400&h=400&fit=crop'},
        {id:16,name:'OPPO Reno11 F 5G 8GB 256GB',brand:'oppo',category:'dienthoai',price:7990000,oldPrice:8990000,discount:11,ram:8,storage:256,screen:'6.7"',camera:'64MP',battery:'5000 mAh',os:'Android 14',features:['tragop'],colors:['#9c27b0','#00bcd4'],image:'https://images.unsplash.com/photo-1565849904461-04a58ad377e0?w=400&h=400&fit=crop'},
        {id:17,name:'HONOR Magic6 Pro 12GB 512GB',brand:'honor',category:'dienthoai',price:24990000,oldPrice:29990000,discount:17,ram:12,storage:512,screen:'6.8"',camera:'180MP',battery:'5600 mAh',os:'Android 14',features:['tragop','freeship'],colors:['#000000','#9e9e9e'],image:'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=400&fit=crop'},
        {id:18,name:'Samsung Galaxy A55 5G 8GB 128GB',brand:'samsung',category:'dienthoai',price:9490000,oldPrice:10990000,discount:14,ram:8,storage:128,screen:'6.6"',camera:'50MP',battery:'5000 mAh',os:'Android 14',features:['tragop'],colors:['#9c27b0','#000000','#90caf9'],image:'https://images.unsplash.com/photo-1610945415295-d9bbf067e59c?w=400&h=400&fit=crop'},
        {id:19,name:'Xiaomi Redmi 13C 6GB 128GB',brand:'xiaomi',category:'dienthoai',price:2990000,oldPrice:3490000,discount:14,ram:6,storage:128,screen:'6.74"',camera:'50MP',battery:'5000 mAh',os:'Android 13',features:['tragop'],colors:['#000000','#4caf50'],image:'https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=400&h=400&fit=crop'},
        {id:20,name:'iPhone 15 128GB',brand:'iphone',category:'dienthoai',price:22990000,oldPrice:24990000,discount:8,ram:6,storage:128,screen:'6.1"',camera:'48MP',battery:'3349 mAh',os:'iOS 17',features:['tragop','freeship'],colors:['#f48fb1','#000000','#90caf9','#ffeb3b'],image:'https://images.unsplash.com/photo-1678685888221-cda269d3b1db?w=400&h=400&fit=crop'},
        {id:21,name:'OPPO A79 5G 8GB 256GB',brand:'oppo',category:'dienthoai',price:6490000,oldPrice:6990000,discount:7,ram:8,storage:256,screen:'6.72"',camera:'50MP',battery:'5000 mAh',os:'Android 13',features:['tragop'],colors:['#9c27b0','#000000'],image:'https://images.unsplash.com/photo-1571066811602-716837d681de?w=400&h=400&fit=crop'},
        {id:22,name:'Samsung Galaxy M34 5G 8GB 128GB',brand:'samsung',category:'dienthoai',price:6290000,oldPrice:6990000,discount:10,ram:8,storage:128,screen:'6.5"',camera:'50MP',battery:'6000 mAh',os:'Android 13',features:['tragop'],colors:['#000000','#2196f3'],image:'https://images.unsplash.com/photo-1585060544812-6b45742d762f?w=400&h=400&fit=crop'},
        {id:23,name:'Xiaomi POCO X6 Pro 12GB 512GB',brand:'xiaomi',category:'dienthoai',price:9990000,oldPrice:10990000,discount:9,ram:12,storage:512,screen:'6.67"',camera:'64MP',battery:'5000 mAh',os:'Android 14',features:['tragop'],colors:['#000000','#ffeb3b'],image:'https://images.unsplash.com/photo-1592286927505-ed01dd7d2c8f?w=400&h=400&fit=crop'},
        {id:24,name:'HONOR X9b 5G 12GB 256GB',brand:'honor',category:'dienthoai',price:6990000,oldPrice:7990000,discount:13,ram:12,storage:256,screen:'6.78"',camera:'108MP',battery:'5800 mAh',os:'Android 13',features:['tragop'],colors:['#9c27b0','#000000'],image:'https://images.unsplash.com/photo-1581993192008-63e896f4f744?w=400&h=400&fit=crop'},
        
        // Phụ kiện
        {id:101,name:'Tai nghe Bluetooth Apple AirPods Pro 2',brand:'apple',category:'phukien',type:'tainghe',price:5990000,oldPrice:6990000,discount:14,image:'https://images.unsplash.com/photo-1606220945770-b5b6c2c55bf1?w=400&h=400&fit=crop',rating:4.5,reviews:152,description:'Tai nghe cao cấp với chống ồn chủ động ANC'},
        {id:102,name:'Tai nghe Bluetooth Samsung Galaxy Buds2 Pro',brand:'samsung',category:'phukien',type:'tainghe',price:3490000,oldPrice:4990000,discount:30,image:'https://images.unsplash.com/photo-1590658165737-15a047b7a0c1?w=400&h=400&fit=crop',rating:4.5,reviews:89,description:'Âm thanh Hi-Fi 24bit với ANC thông minh'},
        {id:103,name:'Tai nghe Bluetooth AirPods 2 Apple',brand:'apple',category:'phukien',type:'tainghe',price:2690000,oldPrice:3190000,discount:16,image:'https://images.unsplash.com/photo-1606841837239-c5a1a4a07af7?w=400&h=400&fit=crop',rating:4,reviews:234,description:'Kết nối tự động với thiết bị Apple'},
        {id:104,name:'Tai nghe Bluetooth Samsung Galaxy Buds FE',brand:'samsung',category:'phukien',type:'tainghe',price:1490000,oldPrice:1990000,discount:25,image:'https://images.unsplash.com/photo-1649859394657-c2c90e82446f?w=400&h=400&fit=crop',rating:4,reviews:67,description:'Thiết kế nhỏ gọn, chống nước IPX7'},
        {id:105,name:'Tai nghe Bluetooth Xiaomi Redmi Buds 5 Pro',brand:'xiaomi',category:'phukien',type:'tainghe',price:1390000,oldPrice:1790000,discount:22,image:'https://images.unsplash.com/photo-1613040809024-b4ef7ba99bc3?w=400&h=400&fit=crop',rating:4,reviews:43,description:'ANC 46dB, pin 38 giờ'},
        {id:201,name:'Cáp Type C 1m Apple MM0A3',brand:'apple',category:'phukien',type:'cap',price:490000,oldPrice:590000,discount:17,image:'https://images.unsplash.com/photo-1625948515291-69613efd103f?w=400&h=400&fit=crop',rating:4.5,reviews:128,description:'Cáp sạc Type-C to Type-C chính hãng'},
        {id:202,name:'Sạc nhanh Type C PD 20W Apple',brand:'apple',category:'phukien',type:'sac',price:490000,oldPrice:590000,discount:17,image:'https://images.unsplash.com/photo-1591290619762-c588ec6ade80?w=400&h=400&fit=crop',rating:4.5,reviews:156,description:'Sạc nhanh PD 20W cho iPhone'},
        {id:301,name:'Ốp lưng iPhone 15 Pro Max MagSafe Apple',brand:'apple',category:'phukien',type:'oplung',price:1190000,oldPrice:1490000,discount:20,image:'https://images.unsplash.com/photo-1601784551446-20c9e07cdbdb?w=400&h=400&fit=crop',rating:4.5,reviews:234,description:'Ốp lưng silicone hỗ trợ MagSafe'},
        {id:302,name:'Ốp lưng iPhone 14 Pro Max MagSafe Apple',brand:'apple',category:'phukien',type:'oplung',price:990000,oldPrice:1290000,discount:23,image:'https://images.unsplash.com/photo-1618088089075-44c3b5e2e283?w=400&h=400&fit=crop',rating:4,reviews:187,description:'Chất liệu silicone mềm mại'},
        {id:303,name:'Ốp lưng Samsung Galaxy S24 Ultra Clear',brand:'samsung',category:'phukien',type:'oplung',price:590000,oldPrice:790000,discount:25,image:'https://images.unsplash.com/photo-1585704768175-39ba0d82bda8?w=400&h=400&fit=crop',rating:4.5,reviews:145,description:'Ốp lưng trong suốt chống sốc'},
        {id:304,name:'Ốp lưng Samsung Galaxy A55 5G Silicone',brand:'samsung',category:'phukien',type:'oplung',price:290000,oldPrice:390000,discount:26,image:'https://images.unsplash.com/photo-1601784551279-3c50e2c96d72?w=400&h=400&fit=crop',rating:4,reviews:98,description:'Mỏng nhẹ, vừa vặn'}
      ];

      // Format price
      function formatPrice(price) {
        return price.toLocaleString('vi-VN') + 'đ';
      }

      // Render product details
      function renderProductDetail(productId) {
        const product = PRODUCTS.find(p => p.id === productId);
        if (!product) {
          document.getElementById('productContainer').innerHTML = `
            <div class="col-span-2 text-center py-20">
              <i class="fas fa-exclamation-triangle text-6xl text-red-600 mb-4"></i>
              <h2 class="text-2xl font-bold mb-2">Không tìm thấy sản phẩm</h2>
              <p class="text-gray-600 mb-6">Sản phẩm bạn đang tìm kiếm không tồn tại.</p>
              <a href="products.html" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition inline-block">
                <i class="fas fa-arrow-left mr-2"></i>Quay lại trang sản phẩm
              </a>
            </div>
          `;
          return;
        }

        // Update breadcrumb
        document.getElementById('breadcrumbProduct').textContent = product.name;
        document.title = `${product.name} - QuangHưng Mobile`;

        // Calculate ratings
        const rating = product.rating || (4 + Math.random() * 1);
        const reviews = product.reviews || Math.floor(Math.random() * 200) + 50;
        const sold = Math.floor(Math.random() * 500) + 100;
        const stock = Math.floor(Math.random() * 50) + 10;
        
        const fullStars = Math.floor(rating);
        const halfStar = rating % 1 >= 0.5;
        let starsHTML = '';
        for(let i = 0; i < fullStars; i++) starsHTML += '<i class="fas fa-star"></i>';
        if(halfStar) starsHTML += '<i class="fas fa-star-half-alt"></i>';
        for(let i = fullStars + (halfStar ? 1 : 0); i < 5; i++) starsHTML += '<i class="far fa-star"></i>';

        // Render product HTML
        const productHTML = `
          <!-- Product Images -->
          <div>
            <div class="bg-white rounded-xl shadow-md p-6 mb-4">
              <img id="mainImage" 
                   src="${product.image}" 
                   alt="${product.name}" 
                   class="w-full h-96 object-contain rounded-lg" />
            </div>
            <div class="grid grid-cols-4 gap-4">
              <img src="${product.image}" 
                   alt="Image 1" 
                   class="w-full h-24 object-contain rounded-lg cursor-pointer border-2 border-red-600 hover:opacity-75 transition p-2 bg-white"
                   onclick="changeImage(this.src)" />
              <img src="${product.image}" 
                   alt="Image 2" 
                   class="w-full h-24 object-contain rounded-lg cursor-pointer border-2 border-gray-200 hover:border-red-600 hover:opacity-75 transition p-2 bg-white"
                   onclick="changeImage(this.src)" />
              <img src="${product.image}" 
                   alt="Image 3" 
                   class="w-full h-24 object-contain rounded-lg cursor-pointer border-2 border-gray-200 hover:border-red-600 hover:opacity-75 transition p-2 bg-white"
                   onclick="changeImage(this.src)" />
              <img src="${product.image}" 
                   alt="Image 4" 
                   class="w-full h-24 object-contain rounded-lg cursor-pointer border-2 border-gray-200 hover:border-red-600 hover:opacity-75 transition p-2 bg-white"
                   onclick="changeImage(this.src)" />
            </div>
          </div>

          <!-- Product Info -->
          <div class="bg-white rounded-xl shadow-md p-6">
            <div class="mb-4 flex flex-wrap gap-2">
              ${product.discount ? `<span class="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-semibold">Giảm ${product.discount}%</span>` : ''}
              <span class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold">Còn hàng</span>
              ${product.features && product.features.includes('freeship') ? '<span class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-semibold"><i class="fas fa-shipping-fast mr-1"></i>Freeship</span>' : ''}
            </div>
            
            <h1 class="text-3xl font-bold mb-3 text-gray-800">${product.name}</h1>
            
            <div class="flex items-center mb-4 flex-wrap gap-3">
              <div class="text-yellow-400 text-lg">
                ${starsHTML}
              </div>
              <span class="text-gray-600">(${rating.toFixed(1)}/5 - ${reviews} đánh giá)</span>
              <span class="text-gray-400">|</span>
              <span class="text-gray-600">Đã bán: ${sold}</span>
            </div>

            <div class="border-t border-b py-4 mb-6">
              <div class="flex items-baseline mb-2">
                <span class="text-4xl font-bold text-red-600">${formatPrice(product.price)}</span>
                ${product.oldPrice ? `<span class="text-xl text-gray-500 line-through ml-3">${formatPrice(product.oldPrice)}</span>` : ''}
              </div>
              ${product.oldPrice ? `<p class="text-sm text-gray-600">Tiết kiệm: ${formatPrice(product.oldPrice - product.price)}</p>` : ''}
            </div>

            ${product.colors && product.colors.length > 0 ? `
            <!-- Color Selection -->
            <div class="mb-6">
              <h3 class="font-semibold mb-3">Màu sắc:</h3>
              <div class="flex space-x-3 flex-wrap gap-2">
                ${product.colors.map((color, index) => `
                  <button class="w-12 h-12 rounded-full border-2 ${index === 0 ? 'border-red-600' : 'border-gray-200'} hover:scale-110 transition" 
                          style="background-color: ${color}"></button>
                `).join('')}
              </div>
            </div>
            ` : ''}

            ${product.category === 'dienthoai' && product.storage ? `
            <!-- Storage Selection -->
            <div class="mb-6">
              <h3 class="font-semibold mb-3">Dung lượng:</h3>
              <div class="grid grid-cols-3 md:grid-cols-4 gap-3">
                <button class="border-2 border-red-600 bg-red-50 rounded-lg py-2 px-4 font-semibold transition text-sm">${product.storage}GB</button>
                ${product.storage < 256 ? '<button class="border-2 border-gray-200 rounded-lg py-2 px-4 hover:border-red-600 transition text-sm">256GB</button>' : ''}
                ${product.storage < 512 ? '<button class="border-2 border-gray-200 rounded-lg py-2 px-4 hover:border-red-600 transition text-sm">512GB</button>' : ''}
              </div>
            </div>
            ` : ''}

            <!-- Quantity -->
            <div class="mb-6">
              <h3 class="font-semibold mb-3">Số lượng:</h3>
              <div class="flex items-center space-x-4">
                <div class="flex items-center border-2 rounded-lg">
                  <button class="px-4 py-2 hover:bg-gray-100 transition" onclick="decreaseQuantity()">
                    <i class="fas fa-minus"></i>
                  </button>
                  <input type="number" id="quantity" value="1" min="1" class="w-16 text-center border-x-2 py-2 outline-none" />
                  <button class="px-4 py-2 hover:bg-gray-100 transition" onclick="increaseQuantity()">
                    <i class="fas fa-plus"></i>
                  </button>
                </div>
                <span class="text-gray-600">Còn ${stock} sản phẩm</span>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="grid grid-cols-2 gap-4 mb-6">
              <button class="bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition flex items-center justify-center shadow-md hover:shadow-lg">
                <i class="fas fa-shopping-cart mr-2"></i>
                Thêm vào giỏ
              </button>
              <button class="bg-gradient-to-r from-red-600 to-red-500 text-white py-3 rounded-lg font-semibold hover:from-red-700 hover:to-red-600 transition flex items-center justify-center shadow-md hover:shadow-lg">
                <i class="fas fa-bolt mr-2"></i>
                Mua ngay
              </button>
            </div>

            <button class="w-full border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:border-red-600 hover:text-red-600 transition flex items-center justify-center">
              <i class="far fa-heart mr-2"></i>
              Thêm vào yêu thích
            </button>

            <!-- Product Features -->
            <div class="mt-6 border-t pt-6">
              <h3 class="font-semibold mb-3">Đặc điểm nổi bật:</h3>
              <ul class="space-y-2 text-gray-700">
                ${product.screen ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>Màn hình: ${product.screen}</span></li>` : ''}
                ${product.camera ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>Camera: ${product.camera}</span></li>` : ''}
                ${product.ram ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>RAM: ${product.ram}GB</span></li>` : ''}
                ${product.storage ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>Bộ nhớ: ${product.storage}GB</span></li>` : ''}
                ${product.battery ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>Pin: ${product.battery}</span></li>` : ''}
                ${product.os ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>Hệ điều hành: ${product.os}</span></li>` : ''}
                ${product.description ? `<li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i><span>${product.description}</span></li>` : ''}
              </ul>
            </div>
          </div>
        `;

        document.getElementById('productContainer').innerHTML = productHTML;
      }

      // Change main image
      function changeImage(src) {
        document.getElementById('mainImage').src = src;
        
        // Update border for selected thumbnail
        document.querySelectorAll('img[onclick]').forEach(img => {
          img.classList.remove('border-red-600');
          img.classList.add('border-gray-200');
        });
        event.target.classList.remove('border-gray-200');
        event.target.classList.add('border-red-600');
      }

      // Quantity controls
      function increaseQuantity() {
        const input = document.getElementById('quantity');
        if (input) input.value = parseInt(input.value) + 1;
      }

      function decreaseQuantity() {
        const input = document.getElementById('quantity');
        if (input && parseInt(input.value) > 1) {
          input.value = parseInt(input.value) - 1;
        }
      }

      // ===== RELATED PRODUCTS =====

      // Render related products
      function renderRelatedProducts(currentProductId) {
        // Get current product to find similar ones
        const currentProduct = PRODUCTS.find(p => p.id === currentProductId);
        if (!currentProduct) return;

        // Find related products (same brand or same category, excluding current product)
        let relatedProducts = PRODUCTS.filter(p => 
          p.id !== currentProductId && 
          (p.brand === currentProduct.brand || p.category === currentProduct.category)
        );

        // Prioritize same brand, then shuffle
        relatedProducts.sort((a, b) => {
          if (a.brand === currentProduct.brand && b.brand !== currentProduct.brand) return -1;
          if (a.brand !== currentProduct.brand && b.brand === currentProduct.brand) return 1;
          return Math.random() - 0.5;
        });

        // Limit to 4 products
        relatedProducts = relatedProducts.slice(0, 4);

        // Render products
        const container = document.getElementById('relatedProducts');
        if (!container) return;

        container.innerHTML = relatedProducts.map(product => {
          const rating = product.rating || (4 + Math.random() * 1);
          const reviews = product.reviews || Math.floor(Math.random() * 200) + 50;
          const fullStars = Math.floor(rating);
          const halfStar = rating % 1 >= 0.5;

          let starsHTML = '';
          for(let i = 0; i < fullStars; i++) starsHTML += '<i class="fas fa-star"></i>';
          if(halfStar) starsHTML += '<i class="fas fa-star-half-alt"></i>';
          for(let i = fullStars + (halfStar ? 1 : 0); i < 5; i++) starsHTML += '<i class="far fa-star"></i>';

          return `
            <a href="product-detail.html?id=${product.id}" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-2xl hover:border-red-300 transition-all duration-300 group">
              <div class="relative overflow-hidden bg-gradient-to-br from-gray-50 to-white">
                ${product.discount ? `
                  <div class="absolute top-3 left-0 z-10">
                    <div class="bg-gradient-to-r from-red-600 to-red-500 text-white text-xs font-bold px-3 py-1.5 rounded-r-full shadow-lg flex items-center gap-1">
                      <i class="fas fa-tag"></i>
                      <span>-${product.discount}%</span>
                    </div>
                  </div>
                ` : ''}
                <div class="p-4">
                  <img src="${product.image}" 
                       alt="${product.name}" 
                       class="w-full h-40 sm:h-52 object-contain group-hover:scale-110 transition-transform duration-500" />
                </div>
              </div>
              <div class="p-4 sm:p-5">
                <h3 class="font-bold mb-3 text-sm sm:text-base line-clamp-2 min-h-[42px] text-gray-800 group-hover:text-red-600 transition-colors">${product.name}</h3>
                
                <div class="flex items-center mb-3 gap-2">
                  <div class="text-yellow-400 text-xs sm:text-sm flex">
                    ${starsHTML}
                  </div>
                  <span class="text-gray-500 text-xs sm:text-sm">({${reviews}})</span>
                </div>
                
                <div class="space-y-1">
                  <div class="flex items-baseline gap-2">
                    <span class="text-xl sm:text-2xl font-bold text-red-600">${formatPrice(product.price)}</span>
                    ${product.oldPrice ? `<span class="text-xs sm:text-sm text-gray-400 line-through">${formatPrice(product.oldPrice)}</span>` : ''}
                  </div>
                  ${product.discount ? `
                    <div class="inline-block">
                      <span class="text-xs bg-red-50 text-red-600 px-2 py-0.5 rounded-md font-semibold">
                        Tiết kiệm ${formatPrice(product.oldPrice - product.price)}
                      </span>
                    </div>
                  ` : ''}
                </div>
                
                <div class="mt-4 pt-3 border-t border-gray-100">
                  <button class="w-full bg-gradient-to-r from-red-600 to-red-500 hover:from-red-700 hover:to-red-600 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-300 transform group-hover:scale-105 shadow-md hover:shadow-lg flex items-center justify-center gap-2 text-sm">
                    <i class="fas fa-shopping-cart"></i>
                    Xem chi tiết
                  </button>
                </div>
              </div>
            </a>
          `;
        }).join('');
      }

      // Load product details and related products on page load
      document.addEventListener('DOMContentLoaded', () => {
        // Get product ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const productId = parseInt(urlParams.get('id')) || 5; // Default to iPhone 15 Pro Max
        
        // Render product details
        renderProductDetail(productId);
        
        // Render related products
        renderRelatedProducts(productId);

        // Mobile menu functionality
        const mobileMenu = document.querySelector('.mobile-menu');
        const mobileMenuButton = document.querySelector('button.md\\:hidden');
        const mobileMenuClose = document.querySelector('.mobile-menu-close');

        if (mobileMenuButton && mobileMenu && mobileMenuClose) {
          mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.remove('hidden');
          });

          mobileMenuClose.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
          });
        }
      });
    </script>
  </body>
</html>

