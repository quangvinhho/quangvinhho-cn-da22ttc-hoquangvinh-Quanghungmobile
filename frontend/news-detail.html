<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Chi tiết tin tức - QuangHưng Mobile</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'red-main': '#d70018',
            'red-dark': '#b01117',
          }
        }
      }
    }
  </script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="components/header.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="responsive.css">
  
  <style>
    * { font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  </style>
</head>
<body class="bg-gray-100">
    <!-- ===== PAGE LOADER - Hiệu ứng loading trang ===== -->
  <div id="page-loader">
    <div class="loader-logo">
      <img src="images/logo.png" alt="QuangHưng Mobile" onerror="this.style.display='none'">
    </div>
    <div class="loader-spinner"></div>
    <div class="loader-dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <div class="loader-text">
      <span>Đ</span><span>a</span><span>n</span><span>g</span><span>&nbsp;</span><span>t</span><span>ả</span><span>i</span><span>.</span><span>.</span><span>.</span>
    </div>
    <div class="loader-progress">
      <div class="loader-progress-bar"></div>
    </div>
  </div>

  
  <div id="header-placeholder"></div>
  <div class="h-[80px] md:h-[100px] lg:h-[140px]"></div>

  <main class="max-w-[1920px] mx-auto px-2 sm:px-3 md:px-4 py-4">
    
    <!-- Khung trắng -->
    <div class="bg-white rounded-xl md:rounded-2xl shadow-sm p-3 sm:p-4 md:p-6">

      <!-- Breadcrumb -->
      <nav class="flex items-center gap-2 text-sm text-gray-500 mb-6 flex-wrap">
        <a href="index.html" class="hover:text-red-main transition">Trang chủ</a>
        <i class="fas fa-chevron-right text-xs"></i>
        <a href="news.html" class="hover:text-red-main transition">Tin tức</a>
        <i class="fas fa-chevron-right text-xs"></i>
        <span id="breadcrumb-title" class="text-gray-700 line-clamp-1">Chi tiết</span>
      </nav>

      <div class="grid lg:grid-cols-3 gap-8">
        
        <!-- Main Content -->
        <div class="lg:col-span-2">
          
          <!-- Article -->
          <article id="news-article">
            <!-- Loading skeleton -->
            <div class="animate-pulse">
              <div class="w-full h-64 md:h-96 bg-gray-200 rounded-2xl mb-6"></div>
              <div class="h-8 bg-gray-200 rounded mb-4 w-3/4"></div>
              <div class="h-4 bg-gray-100 rounded mb-6 w-1/2"></div>
              <div class="space-y-3">
                <div class="h-4 bg-gray-100 rounded"></div>
                <div class="h-4 bg-gray-100 rounded"></div>
                <div class="h-4 bg-gray-100 rounded w-2/3"></div>
              </div>
            </div>
          </article>

          <!-- Related News -->
          <div id="related-news" class="mt-8"></div>
          
        </div>

        <!-- Sidebar -->
        <div class="lg:col-span-1 space-y-6">
          
          <!-- Back to News -->
          <a href="news.html" class="flex items-center gap-3 bg-gray-50 rounded-xl p-4 hover:bg-gray-100 transition group">
            <div class="w-10 h-10 bg-red-main rounded-full flex items-center justify-center">
              <i class="fas fa-arrow-left text-white"></i>
            </div>
            <div>
              <span class="font-semibold text-gray-800 group-hover:text-red-main transition">Quay lại tin tức</span>
              <p class="text-xs text-gray-500">Xem tất cả bài viết</p>
            </div>
          </a>

          <!-- Tin tức khác -->
          <div class="bg-gray-50 rounded-xl p-4">
            <h3 class="font-bold text-gray-900 mb-4 flex items-center">
              <span class="w-1 h-5 bg-red-main mr-2 rounded"></span>TIN TỨC KHÁC
            </h3>
            <div id="other-news" class="space-y-4">
              <!-- Will be loaded -->
            </div>
          </div>

          <!-- Sản phẩm nổi bật -->
          <div class="bg-gray-50 rounded-xl p-4">
            <h3 class="font-bold text-gray-900 mb-4 flex items-center">
              <span class="w-1 h-5 bg-red-main mr-2 rounded"></span>SẢN PHẨM NỔI BẬT
            </h3>
            <div id="hot-products" class="space-y-3">
              <!-- Will be loaded -->
            </div>
          </div>

        </div>
      </div>

    </div>
  </main>

  <div id="footer-placeholder"></div>

  <script src="js/news.js"></script>
  
  <script>
    // Load header & footer
    fetch('components/header.html')
      .then(r => r.text())
      .then(html => {
        document.getElementById('header-placeholder').innerHTML = html;
        const script = document.createElement('script');
        script.src = 'components/header.js';
        document.body.appendChild(script);
      });

    fetch('components/footer.html')
      .then(r => r.text())
      .then(html => {
        document.getElementById('footer-placeholder').innerHTML = html;
      });

    // Load other news for sidebar
    async function loadOtherNews() {
      try {
        const res = await fetch('http://localhost:3000/api/news/featured?limit=5');
        const data = await res.json();
        if (data.success) {
          const container = document.getElementById('other-news');
          container.innerHTML = data.data.slice(0, 4).map(n => `
            <a href="news-detail.html?id=${n.ma_tintuc}" class="flex gap-3 group">
              <div class="w-20 h-14 rounded-lg overflow-hidden flex-shrink-0">
                <img src="${n.anh_dai_dien || 'images/inta.webp'}" alt="${n.tieu_de}" 
                     class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
                     onerror="this.src='images/inta.webp'">
              </div>
              <div class="flex-1 min-w-0">
                <h4 class="font-medium text-sm text-gray-800 line-clamp-2 group-hover:text-red-main transition">${n.tieu_de}</h4>
              </div>
            </a>
          `).join('');
        }
      } catch (e) {
        console.error('Error:', e);
      }
    }

    // Load hot products
    async function loadHotProducts() {
      try {
        const res = await fetch('http://localhost:3000/api/products?limit=4');
        const data = await res.json();
        const products = data.data || data || [];
        if (products.length > 0) {
          const PLACEHOLDER = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2UyZThmMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM2NDc0OGIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWc8L3RleHQ+PC9zdmc+';
          const container = document.getElementById('hot-products');
          container.innerHTML = products.slice(0, 4).map(p => {
            const productId = p.ma_sp || p.id;
            const productName = p.ten_sp || p.name || 'Sản phẩm';
            const productImage = p.anh_dai_dien || p.image || PLACEHOLDER;
            const productPrice = p.gia || p.price || 0;
            return `
            <a href="product-detail.html?id=${productId}" class="flex gap-3 group">
              <img src="${productImage}" alt="${productName}" 
                   class="w-14 h-14 object-cover rounded-lg" onerror="this.src='${PLACEHOLDER}'">
              <div class="flex-1 min-w-0">
                <h4 class="font-medium text-sm text-gray-800 line-clamp-2 group-hover:text-red-main transition">${productName}</h4>
                <p class="text-red-main font-bold text-sm">${Number(productPrice).toLocaleString('vi-VN')}₫</p>
              </div>
            </a>
          `}).join('');
        }
      } catch (e) {
        console.error('Error:', e);
      }
    }

    loadOtherNews();
    loadHotProducts();
  </script>

  <script src="components/floating-share.js"></script>
  <!-- Main JS - Page Loader -->
  <script src="main.js"></script>
</body>
</html>

